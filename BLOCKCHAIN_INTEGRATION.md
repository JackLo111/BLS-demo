# åŒºå—é“¾é›†æˆè¯´æ˜

## æ¦‚è¿°

æ­¤é¡¹ç›®ç°åœ¨æ”¯æŒå°†äº¤æ˜“è®¢å•è®°å½•åˆ°æœ¬åœ°HardhatåŒºå—é“¾ä¸Šï¼Œå®ç°çœŸæ­£çš„å»ä¸­å¿ƒåŒ–äº¤æ˜“è®°å½•ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸŒ åŒºå—é“¾é›†æˆ
- âœ… è®¢å•è®°å½•åˆ°Hardhatæœ¬åœ°é“¾
- âœ… MetaMaské’±åŒ…è¿æ¥
- âœ… æ™ºèƒ½åˆçº¦äº¤äº’
- âœ… å®æ—¶é“¾ä¸Šæ•°æ®åŒæ­¥
- âœ… å¯åˆ‡æ¢æœ¬åœ°/åŒºå—é“¾æ¨¡å¼

### ğŸ”’ éšç§ä¿æŠ¤
- âœ… åŒ¿åäº¤æ˜“ID
- âœ… ä»·æ ¼èŒƒå›´æ¨¡ç³ŠåŒ–
- âœ… éšæœºä¼˜å…ˆçº§åŒ¹é…
- âœ… å»¶è¿Ÿåé¦ˆé˜²æ—¶åºåˆ†æ

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœ¬åœ°HardhatèŠ‚ç‚¹

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
cd hardhat
../start-hardhat.sh
```

æˆ–è€…æ‰‹åŠ¨æ‰§è¡Œï¼š

```bash
cd hardhat
npm install
npx hardhat run scripts/deploy.js --network localhost
npx hardhat node
```

### 2. é…ç½®MetaMask

1. æ‰“å¼€MetaMaskæ‰©å±•
2. ç‚¹å‡»ç½‘ç»œä¸‹æ‹‰èœå•
3. é€‰æ‹©"æ·»åŠ ç½‘ç»œ"
4. è¾“å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **ç½‘ç»œåç§°**: Hardhat Local
   - **æ–°RPC URL**: http://127.0.0.1:8545
   - **é“¾ID**: 31337
   - **è´§å¸ç¬¦å·**: ETH

### 3. å¯åŠ¨å‰ç«¯åº”ç”¨

```bash
# åœ¨æ–°ç»ˆç«¯çª—å£
cd dark-pool-frontend
npm run dev
```

### 4. ä½¿ç”¨åŒºå—é“¾åŠŸèƒ½

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173`
2. ç‚¹å‡»"Connect Wallet"è¿æ¥MetaMask
3. ç¡®ä¿è¿æ¥åˆ°Hardhat Localç½‘ç»œ
4. ç‚¹å‡»"Chain"æŒ‰é’®å¯ç”¨åŒºå—é“¾æ¨¡å¼
5. åˆ›å»ºèº«ä»½å¹¶å¼€å§‹äº¤æ˜“

## æŠ€æœ¯æ¶æ„

### æ™ºèƒ½åˆçº¦ (`hardhat/contracts/DarkPool.sol`)

```solidity
contract DarkPool {
    struct Order {
        bytes32 id;
        address trader;
        bool isBuy;
        uint256 amount;
        uint256 price;
        uint256 timestamp;
        bool executed;
    }

    function placeOrder(bool isBuy, uint256 amount, uint256 price) external returns (bytes32);
    function getAllOrders() external view returns (Order[] memory);
    // ...
}
```

### Web3æœåŠ¡ (`src/services/web3.ts`)

- MetaMaskè¿æ¥ç®¡ç†
- åˆçº¦äº¤äº’å°è£…
- äº‹ä»¶ç›‘å¬
- ç½‘ç»œæ£€æŸ¥

### åŒºå—é“¾å¼•æ“ (`src/services/blockEngineWithChain.ts`)

- æœ¬åœ°+é“¾ä¸Šæ•°æ®åŒæ­¥
- æ··åˆæ¨¡å¼æ”¯æŒ
- å®æ—¶çŠ¶æ€æ›´æ–°

## ä½¿ç”¨æ¨¡å¼

### ğŸ  æœ¬åœ°æ¨¡å¼ (é»˜è®¤)
- è®¢å•ä»…å­˜å‚¨åœ¨æµè§ˆå™¨å†…å­˜ä¸­
- æ— éœ€é’±åŒ…è¿æ¥
- ç”¨äºæ¼”ç¤ºå’Œæµ‹è¯•

### â›“ï¸ åŒºå—é“¾æ¨¡å¼
- è®¢å•è®°å½•åˆ°Hardhaté“¾ä¸Š
- éœ€è¦MetaMaskè¿æ¥
- çœŸå®çš„å»ä¸­å¿ƒåŒ–å­˜å‚¨

## åˆ‡æ¢æ¨¡å¼

åœ¨åº”ç”¨å³ä¸Šè§’ç‚¹å‡»"Local"/"Chain"æŒ‰é’®åˆ‡æ¢æ¨¡å¼ï¼š

- **Local**: çº¯æœ¬åœ°æ¨¡æ‹Ÿ
- **Chain**: åŒºå—é“¾é›†æˆ

## è®¢å•æµç¨‹

### æœ¬åœ°æ¨¡å¼
1. ç”¨æˆ·æäº¤è®¢å•
2. è®¢å•æ·»åŠ åˆ°å½“å‰åŒºå—
3. åŒºå—å®Œæˆåè¿›è¡ŒåŒ¹é…
4. ç»“æœä»…å­˜å‚¨åœ¨å†…å­˜ä¸­

### åŒºå—é“¾æ¨¡å¼
1. ç”¨æˆ·è¿æ¥é’±åŒ…
2. æäº¤è®¢å•åˆ°æ™ºèƒ½åˆçº¦
3. äº¤æ˜“ä¸Šé“¾ç¡®è®¤
4. æœ¬åœ°å¼•æ“åŒæ­¥é“¾ä¸Šæ•°æ®
5. æ‰§è¡Œéšç§åŒ¹é…ç®—æ³•

## éšç§ç‰¹æ€§

å³ä½¿ä½¿ç”¨åŒºå—é“¾ï¼Œä»ä¿æŒéšç§ä¿æŠ¤ï¼š

- ğŸ­ **åŒ¿åID**: ä½¿ç”¨é’±åŒ…åœ°å€çš„å“ˆå¸Œè€Œéæ˜æ–‡
- ğŸŒ«ï¸ **ä»·æ ¼æ¨¡ç³Š**: æ˜¾ç¤ºä»·æ ¼èŒƒå›´è€Œéç²¾ç¡®å€¼
- ğŸ² **éšæœºåŒ¹é…**: é˜²æ­¢åŸºäºæ—¶é—´é¡ºåºçš„æ”»å‡»
- â±ï¸ **å»¶è¿Ÿåé¦ˆ**: æ·»åŠ éšæœºå»¶è¿Ÿé˜²æ—¶åºåˆ†æ

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: MetaMaskæ— æ³•è¿æ¥ï¼Ÿ**
A: ç¡®ä¿HardhatèŠ‚ç‚¹æ­£åœ¨è¿è¡Œï¼Œæ£€æŸ¥RPC URLæ˜¯å¦æ­£ç¡®ã€‚

**Q: äº¤æ˜“å¤±è´¥ï¼Ÿ**
A: æ£€æŸ¥æ˜¯å¦è¿æ¥åˆ°æ­£ç¡®çš„ç½‘ç»œï¼ˆChain ID: 31337ï¼‰ã€‚

**Q: è®¢å•æ²¡æœ‰æ˜¾ç¤ºï¼Ÿ**
A: åˆ·æ–°é¡µé¢ï¼Œæ£€æŸ¥åŒºå—é“¾åŒæ­¥çŠ¶æ€ã€‚

**Q: åˆçº¦åœ°å€ä¸ºç©ºï¼Ÿ**
A: é‡æ–°è¿è¡Œéƒ¨ç½²è„šæœ¬ï¼š`npx hardhat run scripts/deploy.js --network localhost`

### é‡ç½®ç¯å¢ƒ

```bash
# æ¸…ç†Hardhatæ•°æ®
cd hardhat
rm -rf cache/
rm -rf artifacts/
npx hardhat clean

# é‡æ–°éƒ¨ç½²
npx hardhat compile
npx hardhat run scripts/deploy.js --network localhost
npx hardhat node
```

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ™ºèƒ½åˆçº¦**: åœ¨ `hardhat/contracts/` ç›®å½•
2. **å‰ç«¯æœåŠ¡**: åœ¨ `src/services/` ç›®å½•
3. **Reactç»„ä»¶**: åœ¨ `src/components/` ç›®å½•
4. **æ•°æ®ç±»å‹**: åœ¨ `src/types/` ç›®å½•

### æµ‹è¯•

```bash
# æµ‹è¯•æ™ºèƒ½åˆçº¦
cd hardhat
npx hardhat test

# æµ‹è¯•å‰ç«¯
cd dark-pool-frontend
npm run test
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦æé†’**:
- è¿™æ˜¯æ¼”ç¤ºç‰ˆæœ¬ï¼Œè¯·å‹¿åœ¨ä¸»ç½‘ä½¿ç”¨
- ç§é’¥å®‰å…¨ç”±ç”¨æˆ·è‡ªå·±è´Ÿè´£
- æœ¬åœ°èŠ‚ç‚¹ä»…ç”¨äºå¼€å‘æµ‹è¯•
- ç”Ÿäº§ç¯å¢ƒéœ€è¦å®‰å…¨å®¡è®¡

## ä¸‹ä¸€æ­¥å¼€å‘

- [ ] æ·»åŠ æ›´å¤šèµ„äº§æ”¯æŒ
- [ ] å®ç°è·¨é“¾åŠŸèƒ½
- [ ] é›†æˆç¡¬ä»¶é’±åŒ…
- [ ] æ·»åŠ é«˜çº§ZKè¯æ˜
- [ ] ä¼˜åŒ–Gasä½¿ç”¨
- [ ] æ·»åŠ æ²»ç†æœºåˆ¶

---

ğŸ“§ å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ä»£ç æ³¨é‡Šæˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚